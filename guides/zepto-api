<h1 id='zepto'>Zepto</h1>
<p>Zepto allows you to make, get and manage payments using nothing but bank accounts.</p>

<p>It is important to understand that there are 2 main ways Zepto can be used for maximum flexibility:</p>

<ol>
<li>Between Zepto accounts.</li>
<li>Between a Zepto account and anyone.</li>
</ol>

<p>Due to the above, certain endpoints and techniques will differ slightly depending on who you are interacting with. You can find more on this in the <a href="doc:zepto-api#making-payments">Making payments</a> and <a href="doc:zepto-api#getting-paid">Getting paid</a> guides.</p>

<p>And for all kinds of How To&#39;s and Recipes, head on over to our <a href="https://help.zepto.money/en/">Help Guide</a>.</p>
<h1 id='conventions'>Conventions</h1>
<ul>
<li>Authentication is performed using OAuth2. See the <a href="doc:zepto-api#get-started">Get started</a> and <a href="doc:zepto-api#authentication-and-authorisation">Authentication &amp; Authorisation</a> guides for more.</li>
<li>All communication is via <code>https</code> and supports <strong>only</strong> <code>TLSv1.2</code>.</li>
<li>Production API: <code>https://api.zeptopayments.com/</code>.</li>
<li>Production UI: <code>https://go.zeptopayments.com/</code>.</li>
<li>Sandbox API: <code>https://api.sandbox.zeptopayments.com/</code>.</li>
<li>Sandbox UI: <code>https://go.sandbox.zeptopayments.com/</code>.</li>
<li>Data is sent and received as JSON.</li>
<li>Clients should include the <code>Accepts: application/json</code> header in their requests.</li>
<li>Currencies are represented by 3 characters as defined in <a href="http://www.xe.com/iso4217.php">ISO 4217</a>.</li>
<li>Dates &amp; times are returned in UTC using <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> format with second accuracy. With requests, when no TZ is supplied, the configured TZ of the authenticated user is used, or <code>Australia/Sydney</code> if no TZ is configured.</li>
<li>Amounts are always in cents with no decimals unless otherwise stated.</li>
<li>Zepto provides static public IP addresses for all outbound traffic, including webhooks.

<ul>
<li>Sandbox IP: <code>13.237.142.60</code></li>
<li>Production IPs: <code>52.64.11.67</code> and <code>13.238.78.114</code></li>
</ul></li>
</ul>
<h1 id='system-status'>System Status</h1>
<p>Check the platform status, or subscribe to receive notifications at <a href="https://status.zeptopayments.com/">status.zeptopayments.com</a>.
If you would like to check platform status programmatically, please refer to <a href="https://status.zeptopayments.com/api">status.zeptopayments.com/api</a>.</p>
<h1 id='breaking-changes'>Breaking Changes</h1>
<p>A breaking change is assumed to be:</p>

<ul>
<li>Renaming a parameter (request/response)</li>
<li>Removing a parameter (request/response)</li>
<li>Changing a parameter type (request/response)</li>
<li>Renaming a header (request/response)</li>
<li>Removing a header (request/response)</li>
<li>Application of stricter validation rules for request parameters</li>
<li>Reducing the set of possible enumeration values for a request</li>
<li>Changing a HTTP response status code</li>
</ul>

<p>We take backwards compatibility very seriously, and will make every effort to ensure this never changes. In the unfortunate (and rare) case where a breaking change can not be avoided, these will be announced well in
advance, enabling a transition period for API consumers.</p>

<p>The following are not assumed to be a breaking change and must be taken into account by API consumers:</p>

<ul>
<li>Addition of optional new parameters in request</li>
<li>Addition of new parameters in response</li>
<li>Addition of new headers in request</li>
<li>Reordering of parameters in response</li>
<li>Softening of validation rules for request parameters</li>
<li>Increasing the set of possible enumeration values</li>
</ul>

<p>In the case of non breaking changes, a transition period may not be provided, meaning the possibility of such changes occurring must be considered in consumers&#39; logic so as not to break any integrations with both API and Webhooks.</p>
<h1 id='guides'>Guides</h1><h2 id='try-it-out'>Try it out</h2>
<p>The best way to familiarise yourself with our API is by interacting with it.</p>

<p>We&#39;ve preloaded a collection with all our endpoints for you to use in Postman.
Before you start, <strong>import a copy</strong> of our API collection:</p>

<p><a href="https://app.getpostman.com/run-collection/3168734-baa5ff70-4bc2-44d5-9ba6-fcb61839ff41?action=collection%2Ffork&amp;collection-url=entityId%3D3168734-baa5ff70-4bc2-44d5-9ba6-fcb61839ff41%26entityType%3Dcollection%26workspaceId%3D6400ea2b-bb46-421e-a88c-a8625653c35a#?env%5BSplit%20Payments%20Public%20Sandbox%5D=W3sia2V5Ijoic2l0ZV9ob3N0IiwidmFsdWUiOiJodHRwczovL2dvLnNhbmRib3guc3BsaXQuY2FzaCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYXBpX2hvc3QiLCJ2YWx1ZSI6Imh0dHBzOi8vYXBpLnNhbmRib3guc3BsaXQuY2FzaCIsImVuYWJsZWQiOnRydWV9LHsia2V5Ijoib2F1dGgyX2FwcGxpY2F0aW9uX2lkIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6Im9hdXRoMl9zZWNyZXQiLCJ2YWx1ZSI6IiIsImVuYWJsZWQiOnRydWV9LHsia2V5Ijoic2NvcGUiLCJ2YWx1ZSI6InB1YmxpYyBhZ3JlZW1lbnRzIGJhbmtfYWNjb3VudHMgYmFua19jb25uZWN0aW9ucyBjb250YWN0cyBwYXltZW50cyBwYXltZW50X3JlcXVlc3RzIHJlZnVuZF9yZXF1ZXN0cyB0cmFuc2FjdGlvbnMgcmVmdW5kcyBvcGVuX2FncmVlbWVudHMgb2ZmbGluZV9hY2Nlc3MiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6Imlzbzg2MDFfbm93IiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6ImFjY2Vzc190b2tlbiIsInZhbHVlIjoiIiwiZW5hYmxlZCI6dHJ1ZX0seyJrZXkiOiJyZWZyZXNoX3Rva2VuIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfV0="><img src="https://run.pstmn.io/button.svg" alt="Run in Postman" /></a></p>

<p>Okay, let&#39;s get things setup!</p>

<ol>
<li><strong>Create a Zepto account</strong>
If you haven&#39;t already, you&#39;ll want to create a sandbox Zepto account at <a href="https://go.sandbox.zeptopayments.com">https://go.sandbox.zeptopayments.com</a></li>
<li><strong>Register your application with Zepto</strong>
Sign in and create an OAuth2 application: <a href="https://go.sandbox.zeptopayments.com/oauth/applications">https://go.sandbox.zeptopayments.com/oauth/applications</a>.
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_oauth2_app_create.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_oauth2_app_create.png" alt="Zepto OAuth2 app create" /></a></li>
<li><strong>Generate personal access tokens</strong>
The quickest way to access your Zepto account via the API is using personal access tokens. Click on your newly created application from your <a href="https://go.sandbox.zeptopayments.com/oauth%20applications">application list</a> and click on
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_tokens_empty.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_tokens_empty.png" alt="Zepto personal OAuth2 tokens" /></a>
<em>(You&#39;ll have the option to give the token a title)</em>
&gt; <strong><em>NOTE:</em></strong> Please note that personal access tokens do not expire.</li>
<li><strong>Use personal access token in Postman</strong>
You can use this <code>access_token</code> to authorise any requests to the Zepto API in Postman by choosing the <strong>Bearer Token</strong> option under the <strong>Authorization</strong> tab.
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_use_personal_access_token.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_use_personal_access_token.png" alt="Postman use personal OAuth2 tokens" /></a></li>
<li><strong>Make an API request!</strong>
You are now ready to interact with your Zepto account via the API! Go ahead and send a request using Postman.
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_request_response.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_request_response.png" alt="Postman use personal OAuth2 tokens" /></a></li>
</ol>
<h2 id='get-started'>Get started</h2>
<p>This guide will help you setup an OAuth2 app in order to get authenticated &amp; authorised to communicate with the Zepto API.</p>

<p><strong>Before you start:</strong></p>

<ul>
<li>We use the term <strong>user</strong> below but the user can be a third party or the same user that owns the OAuth2 application.</li>
<li>As noted below, some access tokens expire every 2 hours. To get a new access token use the <a href="doc:zepto-api#authentication-and-authorisation">refresh grant strategy</a> to swap a refresh token for a new access token.</li>
</ul>

<ol>
<li><strong>Create a Zepto account</strong>
If you haven&#39;t already, you&#39;ll want to create a sandbox Zepto account at <a href="https://go.sandbox.zeptopayments.com">https://go.sandbox.zeptopayments.com</a>.</li>
<li><strong>Choose authentication method</strong>
All requests to the Zepto API require an <code>access_token</code> for authentication. There are two options for obtaining these tokens, the correct option will depend on your use case:

<ul>
<li><strong>Personal access token</strong> If you only need to access your own Zepto account via the API, then using personal access tokens are the most straight-forward way. Refer to <a href="doc:zepto-api#personal-access-token">Personal access token</a> to setup. These tokens do not expire so no refreshing is required.</li>
<li><strong>OAuth grant flow</strong> When you require your application to act on behalf of other Zepto accounts you&#39;ll need to implement the OAuth grant flow process. Refer to <a href="doc:zepto-api#oauth-grant-flow">OAuth grant flow guide</a> to setup. There is also an <a href="doc:zepto-api#oauth-grant-flow-tutorial">OAuth grant flow tutorial</a>. These access tokens expire every 2 hours, unless the <code>offline_access</code> scope is used in which case the tokens will not expire.</li>
</ul></li>
</ol>
<h2 id='personal-access-token'>Personal access token</h2>
<p>If you&#39;re looking to only access your own account via the API, you can generate a personal access token from the UI. These tokens do not expire, but can be deleted. To do this:</p>

<ol>
<li>Sign in to your Zepto account and <a href="https://go.sandbox.zeptopayments.com/oauth/applications">create an application</a> if you haven&#39;t already. Click on your application from your <a href="https://go.sandbox.zeptopayments.com/oauth/applications">application list</a> and click on <strong>Personal access</strong>.
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_tokens_empty.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_tokens_empty.png" alt="Zepto locate personal OAuth2 tokens" /></a>
<em>(You&#39;ll have the option to give the token a title)</em>
<a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_token.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_personal_access_token.png" alt="Zepto personal OAuth2 tokens" /></a></li>
<li>Now that you have an <code>access_token</code> you can interact with your Zepto account via the API.
To do so, you must simply append the access token to the header of any API request: <code>Authorization: Bearer {access_token}</code></li>
</ol>
<h2 id='oauth-grant-flow'>OAuth grant flow</h2>
<ol>
<li><strong>Register your application with Zepto</strong></li>
</ol>

<p>Once you&#39;ve got your account up and running, sign in and create an OAuth2 profile for your application: <a href="https://go.sandbox.zeptopayments.com/oauth/applications">https://go.sandbox.zeptopayments.com/oauth/applications</a></p>

<p>| Parameter        | Description                                                                                                                                              |
   | ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | <strong>Name</strong>         | The name of your application. When using the <em>Authorisation Grant Flow</em>, users will see this name as the application requesting access to their account. |
   | <strong>Redirect URI</strong> | Set this to your application&#39;s endpoint charged with receiving the authorisation code.                                                                   |</p>

<ol>
<li><strong>Obtain an authorisation code</strong></li>
</ol>

<p>Construct the initial URL the user will need to visit in order to grant your application permission to act on his/her behalf. The constructed URL describes the level of permission (<a href="doc:zepto-api#scopes"><code>scope</code></a>), the application requesting permission (<code>client_id</code>) and where the user gets redirected once they&#39;ve granted permission (<code>redirect_uri</code>).</p>

<p>The URL should be formatted to look like this:
   <code>https://go.sandbox.zeptopayments.com/oauth/authorize?response_type=code&amp;client_id={client_id}&amp;redirect_uri={redirect_uri}&amp;scope={scope}</code></p>

<p>| Parameter       | Description                                                                                |
   | --------------- | ------------------------------------------------------------------------------------------ |
   | <code>response_type</code> | Always set to <code>code</code>                                                                       |
   | <code>client_id</code>     | This is your <code>Application ID</code> as generated when you registered your application with Zepto |
   | <code>redirect_uri</code>  | URL where the user will get redirected along with the newly generated authorisation code   |
   | <code>scope</code>         | The <a href="doc:zepto-api#scopes">scope</a> of permission you&#39;re requesting                          |</p>

<ol>
<li><strong>Exchange the authorisation code for an access token</strong></li>
</ol>

<p>When the user visits the above-mentioned URL, they will be presented with a Zepto login screen and then an authorisation screen:</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_authorize.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_authorize.png" alt="Authorise OAuth2 app" /></a></p>

<p>After the user has authorised your application, they will be returned to your application at the URL specified in <code>redirect_uri</code> along with the <code>code</code> query parameter as the authorisation code.</p>

<p>Finally, the authorisation code can then be exchanged for an access token and refresh token pair by POSTing to: <code>https://go.sandbox.zeptopayments.com/oauth/token</code></p>

<p><strong>Note</strong> The authorisation code is a ONE-TIME use code. It will not work again if you try to POST it a second time.</p>

<p>| Parameter       | Description                                                                                |
   | --------------- | ------------------------------------------------------------------------------------------ |
   | <code>grant_type</code>    | Set to <code>authorization_code</code>                                                                |
   | <code>client_id</code>     | This is your <code>Application ID</code> as generated when you registered your application with Zepto |
   | <code>client_secret</code> | This is your <code>Secret</code> as generated when you registered your application with Zepto         |
   | <code>code</code>          | The authorisation code returned with the user (ONE-TIME use)                               |
   | <code>redirect_uri</code>  | Same URL used in step 3                                                                    |</p>

<ol>
<li><strong>Wrap-up</strong></li>
</ol>

<p>Now that you have an access token and refresh token, you can interact with the Zepto API as the user related to the access token.
   To do so, you must simply append the access token to the header of any API request: <code>Authorization: Bearer {access_token}</code></p>
<h2 id='oauth-grant-flow-tutorial'>OAuth grant flow tutorial</h2>
<p>The OAuth grant flow process is demonstrated using Postman in the steps below.</p>

<p>Before you start, load up our API collection:</p>

<p><a href="https://app.getpostman.com/run-collection/3168734-baa5ff70-4bc2-44d5-9ba6-fcb61839ff41?action=collection%2Ffork&amp;collection-url=entityId%3D3168734-baa5ff70-4bc2-44d5-9ba6-fcb61839ff41%26entityType%3Dcollection%26workspaceId%3D6400ea2b-bb46-421e-a88c-a8625653c35a#?env%5BSplit%20Payments%20Public%20Sandbox%5D=W3sia2V5Ijoic2l0ZV9ob3N0IiwidmFsdWUiOiJodHRwczovL2dvLnNhbmRib3guc3BsaXQuY2FzaCIsImVuYWJsZWQiOnRydWV9LHsia2V5IjoiYXBpX2hvc3QiLCJ2YWx1ZSI6Imh0dHBzOi8vYXBpLnNhbmRib3guc3BsaXQuY2FzaCIsImVuYWJsZWQiOnRydWV9LHsia2V5Ijoib2F1dGgyX2FwcGxpY2F0aW9uX2lkIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6Im9hdXRoMl9zZWNyZXQiLCJ2YWx1ZSI6IiIsImVuYWJsZWQiOnRydWV9LHsia2V5Ijoic2NvcGUiLCJ2YWx1ZSI6InB1YmxpYyBhZ3JlZW1lbnRzIGJhbmtfYWNjb3VudHMgYmFua19jb25uZWN0aW9ucyBjb250YWN0cyBwYXltZW50cyBwYXltZW50X3JlcXVlc3RzIHJlZnVuZF9yZXF1ZXN0cyB0cmFuc2FjdGlvbnMgcmVmdW5kcyBvcGVuX2FncmVlbWVudHMgb2ZmbGluZV9hY2Nlc3MiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6Imlzbzg2MDFfbm93IiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfSx7ImtleSI6ImFjY2Vzc190b2tlbiIsInZhbHVlIjoiIiwiZW5hYmxlZCI6dHJ1ZX0seyJrZXkiOiJyZWZyZXNoX3Rva2VuIiwidmFsdWUiOiIiLCJlbmFibGVkIjp0cnVlfV0="><img src="https://run.pstmn.io/button.svg" alt="Run in Postman" /></a></p>

<p><strong>A screencast of this process is also available:
<a href="https://vimeo.com/246203244">https://vimeo.com/246203244</a>.</strong></p>

<ol>
<li><strong>Create a Zepto account</strong></li>
</ol>

<p>If you haven&#39;t already, you&#39;ll want to create a sandbox Zepto account at <a href="https://go.sandbox.zeptopayments.com">https://go.sandbox.zeptopayments.com</a></p>

<ol>
<li><strong>Register your application with Zepto</strong></li>
</ol>

<p>Sign in and create an OAuth2 application: <a href="https://go.sandbox.zeptopayments.com/oauth/applications">https://go.sandbox.zeptopayments.com/oauth/applications</a>.</p>

<p>Use the special Postman callback URL: <code>https://www.getpostman.com/oauth2/callback</code></p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_oauth2_app_setup.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/split_oauth2_app_setup.png" alt="Zepto OAuth2 app setup" /></a></p>

<ol>
<li><strong>In Postman, setup your environment variables</strong></li>
</ol>

<p>We&#39;ve included the <strong>Zepto Public Sandbox</strong> environment to get you started. Select it in the top right corner of the window then click the <img class="inline-1" alt="Postman Quick-Look icon" src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_quick_look_icon.png" /> icon and click <strong>edit</strong>.</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_zepto_sandbox_environment.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_zepto_sandbox_environment.png" alt="Edit Postman environment" /></a></p>

<p>Using the details from the OAuth2 app you created earlier, fill in the <strong>oauth2_application_id</strong> &amp; <strong>oauth2_secret</strong> fields.</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_zepto_environment_values.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_zepto_environment_values.png" alt="Fill in environment values" /></a></p>

<ol>
<li><strong>Setup the authorization</strong></li>
</ol>

<p>Click on the <strong>Authorization</strong> tab and select <strong>OAuth 2.0</strong></p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_authorization_tab.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_authorization_tab.png" alt="Postman Authorization tab" /></a></p>

<p>Click the <strong>Get New Access Token</strong> button</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_get_new_access_token.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_get_new_access_token.png" alt="Postman get new access token" /></a></p>

<p>Fill in the OAuth2 form as below:</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_oauth2_form.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_oauth2_form.png" alt="Postman OAuth2" /></a></p>

<ol>
<li><strong>Get authorised</strong></li>
</ol>

<p>Click <strong>Request Token</strong> and wait a few seconds and a browser window will popup</p>

<p>Sign in with your Zepto account (or any other Zepto account you want to authorise).</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_signin.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_signin.png" alt="Sign in Zepto to authorise via OAuth2" /></a></p>

<p>Click <strong>Authorise</strong> to allow the app to access the signed in account. Once complete, Postman will automatically exchange the authorisation code it received from Zepto for the <code>access_token/refresh_token</code> pair. It will then store the <code>access_token/refresh_token</code> for you to use in subsequent API requests. The <code>access_token</code> effectively allows you to send requests via the API as the user who provided you authorisation.</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_authorize.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/zepto_oauth2_authorize.png" alt="Authorise OAuth2 app" /></a></p>

<ol>
<li><strong>You&#39;re now ready to use the API</strong></li>
</ol>

<p>Select an endpoint from the Zepto collection from the left hand side menu. Before you send an API request ensure you select your access token and Postman will automatically add it to the request header.</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_use_token.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/postman_use_token.png" alt="Postman use token" /></a></p>

<blockquote>
<p><strong><em>NOTE:</em></strong> Remember to select the access token everytime you try
a new endpoint. Have fun!</p>
</blockquote>
<h2 id='authentication-and-authorisation'>Authentication and Authorisation</h2>
<p>Zepto uses OAuth2 over https to manage authentication and authorisation.</p>

<p>OAuth2 is a protocol that lets external applications request permission from another Zepto user to send requests on their behalf without getting their password.</p>

<p>This is preferred over Basic Authentication because access tokens can be limited by scope and can be revoked by the user at any time.</p>

<p>New to OAuth2? DigitalOcean has a fantastic 5 minute <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-oauth-2#grant-type-authorization-code">introduction to OAuth2</a>.</p>

<p>We currently support the <strong>authorisation code</strong> and <strong>refresh token</strong> grants.</p>
<h3 id='authorisation-code-grant'>Authorisation Code Grant</h3>
<p>This type of grant allows your application to act on behalf of a user. If you&#39;ve ever used a website or application with your</p>

<p>Google, Twitter or Facebook account, this is the grant being used.</p>

<p>See the <a href="doc:zepto-api#get-started">Get Started guide</a> for step by step details on how to use this grant.</p>
<h3 id='refresh-token-grant'>Refresh Token Grant</h3>
<blockquote>
<p>Code sample</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>curl -F "grant_type=refresh_token" \
      -F "client_id={{oauth2_application_id}}" \
      -F "client_secret={{oauth2_application_secret }}" \
      -F "refresh_token={{refresh_token}}" \
      -X POST https://go.sandbox.zeptopayments.com/oauth/token
</code></pre></div>
<blockquote>
<p>Example response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ad0b5847cb7d254f1e2ff1910275fe9dcb95345c9d54502d156fe35a37b93e80"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bearer"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="mi">7200</span><span class="p">,</span><span class="w">
  </span><span class="nl">"refresh_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cc38f78a5b8abe8ee81cdf25b1ca74c3fa10c3da2309de5ac37fde00cbcf2815"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="s2">"public"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>When using the authorisation code grant above, Zepto will return a <code>refresh token</code> along with the access token. Access tokens are short lived and last 2 hours but refresh tokens do not expire.</p>

<p>When the access token expires, instead of sending the user back through the authorisation flow you can use the refresh token to retrieve a new access token with the same permissions as the old one.</p>

<blockquote>
<p><strong><em>NOTE:</em></strong>
The <code>refresh_token</code> gets regenerated and sent alongside the new <code>access_token</code>. In other words, <code>refresh_token</code>s are single use so you&#39;ll want to store the newly generated <code>refresh_token</code> everytime you use it to get a new <code>access_token</code></p>
</blockquote>
<h2 id='making-payments'>Making payments</h2>
<p>In order to payout funds, you&#39;ll be looking to use the <a href="doc:zepto-api#Zepto-API-Payments">Payments</a> endpoint. Whether you&#39;re paying out another Zepto account holder or anyone, the process is the same:</p>

<ol>
<li><p>Add the recipient to your <a href="doc:zepto-api#add-a-contact">Contact</a> list.</p></li>
<li><p><a href="doc:zepto-api#make-a-payment">Make a Payment</a> to your Contact.</p></li>
</ol>

<p>Common use cases:</p>

<ul>
<li><p>Automated payout disbursement (Referal programs, net/commission payouts, etc...)</p></li>
<li><p>Wage payments</p></li>
<li><p>Gig economy payments</p></li>
<li><p>Lending</p></li>
</ul>
<h2 id='getting-paid'>Getting paid</h2><h3 id='posting-a-payment-request'>POSTing a <a href="doc:zepto-api#Zepto-API-Payment-Requests">Payment Request</a></h3>
<p>Provides the ability to send a Payment Request (get paid) to any Contact that has an accepted Agreement in place.</p>

<p>To send a Payment Request to a Contact using the API, you must first have an accepted <a href="https://docs.zeptopayments.com/reference/listoutgoingagreements">Agreement</a> with them.</p>

<p>To do so, you can send them an <a href="https://help.zepto.money/agreements/open-agreement">Open Agreement link</a> or <a href="http://help.zepto.money/agreements/unassigned-agreement">Unassigned Agreement link</a> for them to <a href="https://help.zepto.money/bank-accounts/instant-account-verification-iav">Select &amp; verify their bank account</a> and accept the Agreement.</p>

<p>Having this in place will allow any future Payment Requests to be automatically approved and processed as per the Agreement terms.</p>

<p>Common use cases:</p>

<ul>
<li><p>Subscriptions</p></li>
<li><p>On-account balance payments</p></li>
<li><p>Bill smoothing</p></li>
<li><p>Repayment plans</p></li>
</ul>

<p>Example flow embedding an <a href="https://help.zepto.money/agreements/open-agreement">Open Agreement link</a> using an iFrame in order to automate future Payment Request approvals:</p>

<p><a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/host_oa.png"><img src="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/host_oa.png" alt="Hosted Open Agreement" /></a></p>
<h2 id='idempotent-requests'>Idempotent requests</h2>
<blockquote>
<p>Example response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Duplicate idempotency key"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A resource has already been created with this idempotency key"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"about"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://docs.zepto.money/"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"resource_ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PB.1a4"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>The Zepto API supports idempotency for safely retrying requests without accidentally performing the same operation twice.</p>

<p>For example, if a [Make a Payment] is <code>POST</code>ed and a there is a network connection error, you can retry the Payment with the same idempotency key to guarantee that only a single Payment is created. In case an idempotency key is not supplied and a Payment is retried, we would treat this as two different payments being made.</p>

<p>To perform an idempotent request, provide an additional <code>Idempotency-Key:&lt;key&gt;</code> header to the request.</p>

<p>You can pass any value (up to 256 characters) as the key but we suggest <a href="https://uuid7.com/">V7 UUIDs</a> or another appropriately random string.</p>

<p>Keys expire after 24 hours. If there is a subsequent request with the same idempotency key within the 24 hour period, we will return a <code>409 Conflict</code>.</p>

<ul>
<li><p>The <code>meta.resource_ref</code> value is the reference of the resource that was previously created with the conflicting idempotency key.</p></li>
<li><p>The <code>Idempotency-Key</code> header is optional but recommended.</p></li>
<li><p>Only the <code>POST</code> action for the Payments, Payment Requests and Refunds endpoints support the use of the <code>Idempotency-Key</code>.</p></li>
<li><p>Endpoints that use the <code>GET</code> or <code>DELETE</code> actions are idempotent by nature.</p></li>
<li><p>A request that quickly follows another with the same idempotency key may return with <code>503 Service Unavailable</code>. If so, retry the request after the number of seconds specified in the <code>Retry-After</code> response header.</p></li>
</ul>

<p>Currently the following <code>POST</code> requests can be made idempotent. We <strong>strongly recommend</strong> sending a unique <code>Idempotency-Key</code> header when making those requests to allow for safe retries:</p>

<ul>
<li><p><a href="doc:zepto-api#request-payment">Request Payment</a></p></li>
<li><p><a href="doc:zepto-api#make-a-payment">Make a Payment</a></p></li>
<li><p><a href="doc:zepto-api#issue-a-refund">Issue a Refund</a></p></li>
</ul>
<h2 id='error-responses'>Error responses</h2>
<blockquote>
<p>Example detailed error response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A Specific Error"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Details about the error"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"about"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://docs.zepto.money/..."</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Example resource error response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"errors"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A sentence explaining error/s encounted"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>The Zepto API returns two different types of error responses depending on the context.</p>

<p><strong>Detailed error responses</strong> are returned for:</p>

<ul>
<li><p>Authentication</p></li>
<li><p>Request types</p></li>
<li><p>Idempotency</p></li>
</ul>

<p>All other errors relating to Zepto specific resources(e.g. Contacts) will return the <strong>Resource error response</strong> style.</p>
<h3 id='403-errors'>403 errors</h3>
<p><strong>403 errors</strong> are generally returned from any of our endpoints if your application does not have the required authorisation. This is usually due to:</p>

<ul>
<li><p>An <a href="doc:zepto-api#authentication-and-authorisation">invalid/expired <code>access_token</code></a>; or</p></li>
<li><p>The required <strong>scopes</strong> not being present when setting up your <a href="https://go.sandbox.zeptopayments.com/oauth/applications">OAuth application</a>; or</p></li>
<li><p>The required <strong>scopes</strong> not being present in the <a href="doc:zepto-api#oauth-grant-flow">authorisation code link</a> used to present your user with an authorisation request.</p></li>
</ul>
<h2 id='speeding-up-onboarding'>Speeding up onboarding</h2>
<p>Consider the following scenario:</p>

<blockquote>
<p>Zepto is integrated in your application to handle payments.</p>

<p>A customer would like to use Zepto but does not yet have Zepto account.</p>

<p>You already have some information about this customer.</p>
</blockquote>

<p>Given the above, in a standard implementation where a customer enables/uses Zepto within your application, these are the steps they would follow:</p>

<ol>
<li><p>Click on some sort of button within your app to use Zepto.</p></li>
<li><p>They get redirected to the Zepto sign in page (possibly via a popup or modal).</p></li>
<li><p>Since they don&#39;t yet have a Zepto account, they would click on sign up.</p></li>
<li><p>They would fill in all their signup details and submit.</p></li>
<li><p>They would be presented with the <a href="https://raw.githubusercontent.com/zeptofs/public_assets/master/images/oauth2_app_authorise.png">authorisation page</a>.</p></li>
<li><p>They would click the &quot;Authorise&quot; button and be redirected to your app.</p></li>
</ol>

<p>Whilst not too bad, we can do better!</p>

<p>In order to speed up the process, we allow query string params to be appended to the <a href="doc:zepto-api#get-started">authorisation URL</a>. For instance, if we already have some information about the customer and know they probably don&#39;t have a Zepto account, we can embed this information in the authorisation URL.</p>

<p><strong>Supported query string parameters</strong></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>landing</code></td>
<td>Accepted value: <code>sign_up</code>. What page the user should see first if not already signed in Default is the sign in page.Deprecated values: <code>business_sign_up</code>, <code>personal_sign_up</code>.</td>
</tr>
<tr>
<td><code>nickname</code></td>
<td>Only letters, numbers, dashes and underscores are permitted.</td>
</tr>
<tr>
<td>This will be used to identify the account in Zepto.</td>
<td></td>
</tr>
<tr>
<td><code>name</code></td>
<td>Business account only. Business name.</td>
</tr>
<tr>
<td><code>abn</code></td>
<td>Business account only. Business ABN.</td>
</tr>
<tr>
<td><code>phone</code></td>
<td>Business account only. Business phone number.</td>
</tr>
<tr>
<td><code>street_address</code></td>
<td></td>
</tr>
<tr>
<td><code>suburb</code></td>
<td></td>
</tr>
<tr>
<td><code>state</code></td>
<td>See the sign up page for accepted values</td>
</tr>
<tr>
<td><code>postcode</code></td>
<td></td>
</tr>
<tr>
<td><code>first_name</code></td>
<td></td>
</tr>
<tr>
<td><code>last_name</code></td>
<td></td>
</tr>
<tr>
<td><code>mobile_phone</code></td>
<td></td>
</tr>
<tr>
<td><code>email</code></td>
<td></td>
</tr>
</tbody></table>

<p>All values should be <a href="https://en.wikipedia.org/wiki/Query_string#URL_encoding">URL encoded</a>.</p>

<p>As an example, the following authorisation URL would display the <strong>personal sign up</strong> &amp; prefill the first name field with <strong>George</strong>:</p>

<p><code>https://go.sandbox.zeptopayments.com/oauth/authorize?response_type=code&amp;client_id=xxx&amp;redirect_uri=xxx&amp;scope=xxx&amp;landing=sign_up&amp;first_name=George</code></p>

<p>You can also pass the values directly to the sign up page outside of the OAuth2 authorisation process. Click on the following link to see the values preloaded:
<a href="https://go.sandbox.zeptopayments.com/business/sign_up?name=GeorgeCo&amp;nickname=georgceco&amp;first_name=George">https://go.sandbox.zeptopayments.com/business/sign_up?name=GeorgeCo&amp;nickname=georgeco&amp;first_name=George</a>.</p>
<h1 id='sandbox-testing-details'>Sandbox Testing Details</h1>
<blockquote>
<p>Example failure object</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"failure"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"E302"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BSB Not NPP Enabled"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"detail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The target BSB is not NPP enabled. Please try another channel."</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Try out your happy paths and not-so happy paths; the sandbox is a great place to get started without transferring actual funds. All transactions are simulated and no communication with financial institutions is performed.</p>

<p>The sandbox works on a 1 minute cycle to better illustrate how transactions are received and the lifecyle they go through. In other words, every minute, we simulate communicating with financial institutions and update statuses and events accordingly.</p>

<p>All 6 digits BSBs are valid in the sandbox with the exception of <code>100000</code>. This BSB allows you to simulate the adding of an invalid BSB. In production, only real BSBs are accepted.</p>

<p>Failed transactions will contain the following information inside the event:</p>

<ul>
<li><p>Failure Code</p></li>
<li><p>Failure Title</p></li>
<li><p>Failure Details</p></li>
</ul>
<h2 id='de-transaction-failures'>DE Transaction failures</h2><h3 id='using-failure-codes'>Using failure codes</h3>
<blockquote>
<ul>
<li><a href="https://help.zepto.money/en/articles/5633407-au-transaction-failure-responses#h_b2229b3745">DE credit failure codes</a></li>
<li><a href="https://help.zepto.money/en/articles/5633407-au-transaction-failure-responses#h_b15d7bd439">DE debit failure codes</a></li>
</ul>
</blockquote>

<p>To simulate a transaction failure, create a Payment or Payment Request with an amount corresponding to the desired failure code.</p>

<p>For example:</p>

<ul>
<li><p>DE amount <code>$1.05</code> will cause the credit transaction to fail, triggering the credit failure code <code>E105</code> (Account Not Found).</p></li>
<li><p>DE amount <code>$2.03</code> will cause the debit transaction to fail, triggering the debit failure code <code>E203</code> (Account Closed).</p></li>
</ul>
<h3 id='example-scenarios'>Example scenarios</h3>
<ol>
<li>Pay a contact with an invalid account number:</li>
</ol>
<div class="highlight"><pre class="highlight plaintext"><code>* Initiate a Payment for `$1.05`.
* Zepto will mimic a successful debit from your bank account.
* Zepto will mimic a failure to credit the contact's bank account.
* Zepto will automatically create a `payout_reversal` credit transaction back to your bank account.
</code></pre></div>
<ol>
<li>Request payment from a contact with a closed bank account:</li>
</ol>
<div class="highlight"><pre class="highlight plaintext"><code>* Initiate a Payment Request for `$2.03`.
* Zepto will mimic a failure to debit the contact's bank account.
</code></pre></div><h2 id='npp-payment-failures'>NPP Payment failures</h2><h3 id='using-failure-codes-2'>Using failure codes</h3>
<blockquote>
<ul>
<li><a href="https://help.zepto.money/en/articles/5633407-au-transaction-failure-responses#h_81961f33a0">NPP credit failure codes</a></li>
</ul>
</blockquote>

<p>To simulate a transaction failure, create a Payment with an amount corresponding to the desired failure code.</p>

<p>For example:</p>

<ul>
<li><p>NPP amount <code>$3.02</code> will cause the transaction to fail, triggering credit failure code <code>E302</code> (BSB Not NPP Enabled).</p></li>
<li><p>NPP amount <code>$3.04</code> will cause the transaction to fail, triggering credit failure code <code>E304</code> (Account Not Found).</p></li>
</ul>

<p>You will receive all the same notifications as if this happened in our live environment. We recommend you check out our article on <a href="https://help.zepto.money/en/articles/4405560-what-happens-when-an-npp-payment-fails">what happens when an NPP Payment fails</a> to learn more about what happens when an NPP Payment is unable to process.</p>
<h2 id='npp-payment-channel-switching-failures'>NPP Payment channel-switching failures</h2><h3 id='using-failure-codes-3'>Using failure codes</h3>
<p>To simulate a transaction failure across both NPP and DE channels, create a Payment with an amount corresponding to the desired <a href="https://help.zepto.money/en/articles/5633407-au-transaction-failure-responses#h_b2229b3745">DE credit failure code</a>. The NPP leg of the payment will fail with error code E303 (this is to facilitate channel-switching where the transaction is set up to do so). If the transaction switches channels the DE leg of the payment will fail with the <a href="https://help.zepto.money/en/articles/5633407-au-transaction-failure-responses#h_b2229b3745">DE credit failure code</a> that corresponds to the amount.</p>

<p>For example:</p>

<ul>
<li><p>payment amount <code>$1.02</code> will fail with code <code>E303</code> (Account Not NPP Enabled). If the payment channel-switches it will also fail DE processing with code <code>E102</code> (Payment Stopped).</p></li>
<li><p>payment amount <code>$1.05</code> will fail with code <code>E303</code> (Account Not NPP Enabled). If the payment channel-switches it will also fail DE processing with code <code>E105</code> (Account Not Found).</p></li>
<li><p>payment amount <code>$1.10</code> will succeed NPP processing, as there is no corresponding DE credit failure code for that amount.</p></li>
</ul>
<h2 id='instant-account-verification-accounts'>Instant account verification accounts</h2>
<p>When using any of our hosted solutions (<a href="https://help.zepto.money/en/?q=payment+request">Payment Requests</a>,
<a href="https://help.zepto.money/agreements/open-agreement">Open Agreements</a> or
<a href="http://help.zepto.money/agreements/unassigned-agreement">Unassigned Agreements</a>) you may want to test the <a href="http://help.zepto.money/bank-accounts/instant-account-verification-iav">Instant Account Verification (IAV)</a> process where we accept online banking credentials to validate bank account access. To do so, you can use the following credentials:</p>

<table><thead>
<tr>
<th>Login</th>
<th>Password</th>
</tr>
</thead><tbody>
<tr>
<td><code>12345678</code></td>
<td><code>TestMyMoney</code></td>
</tr>
</tbody></table>

<blockquote>
<p><strong><em>NOTE:</em></strong> The credentials will work with any of the available financial institutions.</p>
</blockquote>
<h1 id='configuration'>Configuration</h1><h2 id='scopes'>Scopes</h2>
<p>Scopes define the level of access granted via the OAuth2 authorisation process. As a best practice, only use the scopes your application will require.</p>

<table><thead>
<tr>
<th>Scope</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>public</code></td>
<td>View user&#39;s public information</td>
</tr>
<tr>
<td><code>agreements</code></td>
<td>Manage user&#39;s Agreements</td>
</tr>
<tr>
<td><code>bank_accounts</code></td>
<td>Manage user&#39;s Bank Accounts</td>
</tr>
<tr>
<td><code>bank_connections</code></td>
<td>Manage user&#39;s Bank Connections</td>
</tr>
<tr>
<td><code>contacts</code></td>
<td>Manage user&#39;s Contacts</td>
</tr>
<tr>
<td><code>open_agreements</code></td>
<td>Manage user&#39;s Open Agreements</td>
</tr>
<tr>
<td><code>payments</code></td>
<td>Manage user&#39;s Payments</td>
</tr>
<tr>
<td><code>payment_requests</code></td>
<td>Manage user&#39;s Payment Requests</td>
</tr>
<tr>
<td><code>refunds</code></td>
<td>Manage user&#39;s Refunds</td>
</tr>
<tr>
<td><code>transfers</code></td>
<td>Manage user&#39;s Transfers</td>
</tr>
<tr>
<td><code>transactions</code></td>
<td>Access user&#39;s Transactions</td>
</tr>
<tr>
<td><code>webhooks</code></td>
<td>Manage user&#39;s Webhook events</td>
</tr>
<tr>
<td><code>offline_access</code></td>
<td>Create non-expiring access tokens for user</td>
</tr>
</tbody></table>

<blockquote>
<p><strong><em>NOTE:</em></strong> Please use <code>offline_access</code> with discretion, as you&#39;ll have no direct way to invalidate the token. Please contact Zepto immediately if any token may have potentially been compromised.</p>
</blockquote>
<h2 id='pagination'>Pagination</h2>
<blockquote>
<p>Example response headers</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>Link: &lt;http://api.sandbox.zeptopayments.com/contacts?page=2&gt;; rel="next"

Per-Page: 25

</code></pre></div>
<p>Pagination information can be located in the response headers: <code>Link</code> &amp; <code>Per-Page</code></p>

<p>All collection endpoints are paginated to <code>Per-Page: 25</code> by default. (<code>100</code> per page is max, any value above will revert to <code>100</code>)</p>

<p>You can control the pagination by including <code>per_page=x</code> and/or <code>page=x</code> in the endpoint URL params.</p>

<p>The <code>Link</code> header will be optionally present if a &quot;next page&quot; is available to navigate to. The next page link is identified with <code>rel=&quot;next&quot;</code></p>

<blockquote>
<p><strong>Legacy Pagination</strong>: Some existing users may still be on a transitional legacy version of pagination.</p>

<p>The Legacy version returns some extra <strong>deprecated header values: <code>Total</code> plus <code>rel=&quot;last&quot;</code> &amp; <code>rel=&quot;prev&quot;</code> in <code>Link</code></strong>.</p>

<p>Please transition to only using the <code>rel=&quot;next&quot;</code> from the <code>Link</code> header, as all other values are deprecated.</p>
</blockquote>
<h2 id='remitter'>Remitter</h2>
<blockquote>
<p>Example request</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"..."</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"remitter"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CustomRem"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>You can elect to assign a remitter name on a per-request basis when submitting Payments &amp; Payment Requests. Simply append the <code>remitter</code> key and a value within the <code>metadata</code> key.</p>

<ul>
<li><p><strong>For Payments</strong>, the party being credited will see the designated remitter name along the entry on their bank statement.</p></li>
<li><p><strong>For Payment Requests</strong>, the party being debited will see the designated remitter name along the entry on their bank statement.</p></li>
</ul>

<blockquote>
<p><strong><em>NOTE:</em></strong> The remitter name MUST be between <code>3</code> and <code>16</code> characters.</p>
</blockquote>
<h2 id='aggregation'>Aggregation</h2>
<p>Zepto will automatically aggregate debits that are:</p>

<ul>
<li><p>From the same bank account; and</p></li>
<li><p>Have the same description; and</p></li>
<li><p>Initiated by the same Zepto account.</p></li>
</ul>

<p>Likewise for credits:</p>

<ul>
<li><p>To the same bank account; and</p></li>
<li><p>Have the same description; and</p></li>
<li><p>Initiated by the same Zepto account.</p></li>
</ul>

<p>Should you prefer debit aggregation to be disabled, please contact <a href="mailto:support@zepto.com.au">support@zepto.com.au</a>. Note that additional charges may apply.</p>
<h2 id='webhooks'>Webhooks</h2>
<blockquote>
<p>Example response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object.action"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yyyy-mm-ddThh:mm:ssZ"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"who"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"bank_account_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Please refer to our help centre <a href="http://help.zepto.money/en/articles/3303626-webhooks">article on webhooks</a> for more information and an overview of what you can achieve with webhooks.</p>

<p>We support two main categories of webhooks:</p>

<ol>
<li><p><strong>Owner</strong>: These webhooks are managed by the owner of the Zepto account and only report on events owned by the Zepto account.</p></li>
<li><p><strong>App</strong>: These webhooks are managed by the Zepto OAuth2 application owner and will report on events relating to any authorised Zepto account (limited by scope).</p></li>
</ol>

<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>event</td>
<td>object</td>
<td>true</td>
<td>Webhook event details</td>
</tr>
<tr>
<td> type</td>
<td>string</td>
<td>true</td>
<td>The webhook event key (list available in the webhook settings)</td>
</tr>
<tr>
<td> at</td>
<td>string(date-time)</td>
<td>true</td>
<td>When the event occurred</td>
</tr>
<tr>
<td> who</td>
<td>object</td>
<td>true</td>
<td>Who the webhook event relates to</td>
</tr>
<tr>
<td> account_id</td>
<td>string(uuid)</td>
<td>true</td>
<td>The Zepto account who&#39;s the owner of the event</td>
</tr>
<tr>
<td> bank_account_id</td>
<td>string(uuid)</td>
<td>true</td>
<td>The above Zepto account&#39;s bank account</td>
</tr>
<tr>
<td>data</td>
<td>[object]</td>
<td>true</td>
<td>Array of response bodies</td>
</tr>
</tbody></table>
<h3 id='data-schemas'>Data schemas</h3>
<p>Use the following table to discover what type of response schema to expect for for the <code>data.[{}]</code> component of the webhook delivery.</p>

<table><thead>
<tr>
<th>Event</th>
<th>Data schema</th>
</tr>
</thead><tbody>
<tr>
<td><code>agreement.*</code></td>
<td><a href="ref:getagreement">GetAnAgreementResponse</a></td>
</tr>
<tr>
<td><code>contact.*</code></td>
<td><a href="ref:getacontact">GetAContactResponse</a></td>
</tr>
<tr>
<td><code>credit.*</code></td>
<td><a href="ref:listalltransactions">ListAllTransactionsResponse</a></td>
</tr>
<tr>
<td><code>creditor_debit.*</code></td>
<td><a href="ref:listalltransactions">ListAllTransactionsResponse</a></td>
</tr>
<tr>
<td><code>debit.*</code></td>
<td><a href="ref:listalltransactions">ListAllTransactionsResponse</a></td>
</tr>
<tr>
<td><code>debtor_credit.*</code></td>
<td><a href="ref:listalltransactions">ListAllTransactionsResponse</a></td>
</tr>
<tr>
<td><code>open_agreement.*</code></td>
<td><a href="ref:listallopenagreements">ListAllOpenAgreementsRespose</a></td>
</tr>
<tr>
<td><code>payment.*</code></td>
<td><a href="ref:getapayment">GetAPaymentResponse</a></td>
</tr>
<tr>
<td><code>payment_request.*</code></td>
<td><a href="ref:getapaymentrequest">GetAPaymentRequestResponse</a></td>
</tr>
<tr>
<td><code>unassigned_agreement.*</code></td>
<td><a href="ref:getunassignedagreement">GetAnUnassignedAgreementResponse</a></td>
</tr>
</tbody></table>
<h3 id='our-delivery-promises'>Our Delivery Promises</h3>
<ol>
<li><p>We only consider a webhook event delivery as failed if we don&#39;t receive any http response code (2xx, 4xx, 5xx, etc.)</p></li>
<li><p>We will auto-retry failed deliveries every 5 minutes for 1 hour.</p></li>
<li><p>Delivery order for webhook events is not guaranteed.</p></li>
<li><p>We guarantee at least 1 delivery attempt.</p></li>
</ol>

<p><strong>For redelivery of webhooks, check out our <a href="#Zepto-API-Webhooks">Webhook/WebhookDelivery API endpoints</a>.</strong></p>

<blockquote>
<p><strong><em>NOTE:</em></strong> In the sandbox environment, webhook deliveries will only be retried once, to allow for easier testing of failure scenarios.</p>
</blockquote>
<h3 id='request-id'>Request ID</h3>
<blockquote>
<p>Example header</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>Split-Request-ID: 07f4e8c1-846b-5ec0-8a25-24c3bc5582b5

</code></pre></div>
<p>Zepto provides a <code>Split-Request-ID</code> header in the form of a <code>UUID</code> which uniquely identifies a webhook event. If the webhook event is retried/retransmitted by Zepto, the UUID will remain the same. This allows you to check if a webhook event has been previously handled/processed.</p>
<h3 id='checking-webhook-signatures'>Checking Webhook Signatures</h3>
<blockquote>
<p>Example header</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>Split-Signature:
1514772000.93eee90206280b25e82b38001e23961cba4c007f4d925ba71ecc2d9804978635

</code></pre></div>
<p>Zepto signs the webhook events it sends to your endpoints. We do so by including a signature in each events <code>Split-Signature</code> header. This allows you to validate that the events were indeed sent by Zepto.</p>

<p>Before you can verify signatures, you need to retrieve your endpoints secret from your Webhooks settings. Each endpoint has its own unique secret; if you use multiple endpoints, you must obtain a secret for each one.</p>

<p>The <code>Split-Signature</code> header contains a timestamp and one or more signatures. All separated by <code>.</code> (dot).</p>

<blockquote>
<p>Example code</p>
</blockquote>
<div class="highlight"><pre class="highlight sh tab-shell"><code>
<span class="c"># Shell example is not available</span>

</code></pre></div><div class="highlight"><pre class="highlight go tab-go"><code>
<span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/hmac"</span>
    <span class="s">"crypto/sha256"</span>
    <span class="s">"strings"</span>
    <span class="s">"fmt"</span>
    <span class="s">"encoding/hex"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">secret</span> <span class="o">:=</span> <span class="s">"1234"</span>
    <span class="n">message</span> <span class="o">:=</span> <span class="s">"full payload of the request"</span>
    <span class="n">splitSignature</span> <span class="o">:=</span> <span class="s">"1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f"</span>

    <span class="n">data</span> <span class="o">:=</span> <span class="n">strings</span><span class="o">.</span><span class="n">Split</span><span class="p">(</span><span class="n">splitSignature</span><span class="p">,</span> <span class="s">"."</span><span class="p">)</span>
    <span class="n">timestamp</span><span class="p">,</span> <span class="n">givenSignature</span> <span class="o">:=</span> <span class="n">data</span><span class="p">[</span><span class="m">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>

    <span class="n">signedPayload</span> <span class="o">:=</span> <span class="n">timestamp</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">message</span>

    <span class="n">hash</span> <span class="o">:=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="n">sha256</span><span class="o">.</span><span class="n">New</span><span class="p">,</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="n">secret</span><span class="p">))</span>
    <span class="n">hash</span><span class="o">.</span><span class="n">Write</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="n">signedPayload</span><span class="p">))</span>
    <span class="n">expectedSignature</span> <span class="o">:=</span> <span class="n">hex</span><span class="o">.</span><span class="n">EncodeToString</span><span class="p">(</span><span class="n">hash</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="no">nil</span><span class="p">))</span>

    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">expectedSignature</span><span class="p">)</span>
    <span class="c">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">givenSignature</span><span class="p">)</span>
    <span class="c">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>
<span class="p">}</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="kn">import</span> <span class="nn">hmac</span>


<span class="n">split_signature</span> <span class="o">=</span> <span class="s">'1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f'</span>

<span class="n">secret</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">'1234'</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>

<span class="n">message</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s">'full payload of the request'</span><span class="p">).</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>


<span class="n">data</span> <span class="o">=</span> <span class="n">split_signature</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span>

<span class="n">timestamp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">given_signature</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="n">signed_payload</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">+</span> <span class="s">'.'</span> <span class="o">+</span> <span class="n">message</span>


<span class="n">expected_signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">,</span> <span class="n">signed_payload</span><span class="p">,</span>
<span class="n">digestmod</span><span class="o">=</span><span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>


<span class="k">print</span><span class="p">(</span><span class="n">expected_signature</span><span class="p">)</span>

<span class="c1"># &gt; f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f
</span>

<span class="k">print</span><span class="p">(</span><span class="n">given_signature</span><span class="p">)</span>

<span class="c1"># &gt; f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f
</span>
</code></pre></div><div class="highlight"><pre class="highlight ruby tab-ruby"><code>
<span class="nb">require</span> <span class="s1">'openssl'</span>


<span class="n">split_signature</span> <span class="o">=</span>
<span class="s1">'1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f'</span>

<span class="n">secret</span> <span class="o">=</span> <span class="s1">'1234'</span>

<span class="n">message</span> <span class="o">=</span> <span class="s1">'full payload of the request'</span>


<span class="n">timestamp</span><span class="p">,</span> <span class="n">given_signature</span><span class="p">,</span> <span class="o">*</span><span class="n">other</span> <span class="o">=</span> <span class="n">split_signature</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>

<span class="n">signed_payload</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">+</span> <span class="s1">'.'</span> <span class="o">+</span> <span class="n">message</span>

<span class="n">expected_signature</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">HMAC</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">(</span><span class="s1">'sha256'</span><span class="p">,</span> <span class="n">secret</span><span class="p">,</span>
<span class="n">signed_payload</span><span class="p">)</span>


<span class="nb">puts</span><span class="p">(</span><span class="n">expected_signature</span><span class="p">)</span>

<span class="c1"># =&gt; f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>

<span class="nb">puts</span><span class="p">(</span><span class="n">given_signature</span><span class="p">)</span>

<span class="c1"># =&gt; f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>

</code></pre></div><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">message</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">full payload of the request</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">1234</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">splitSignature</span> <span class="o">=</span>
  <span class="dl">"</span><span class="s2">1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">splitSignature</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">.</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="kd">var</span> <span class="nx">givenSignature</span> <span class="o">=</span> <span class="nx">data</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

<span class="kd">var</span> <span class="nx">signedPayload</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">.</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">message</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">expectedSignature</span> <span class="o">=</span> <span class="nx">crypto</span>
  <span class="p">.</span><span class="nx">createHmac</span><span class="p">(</span><span class="dl">"</span><span class="s2">sha256</span><span class="dl">"</span><span class="p">,</span> <span class="nx">secret</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">signedPayload</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">digest</span><span class="p">(</span><span class="dl">"</span><span class="s2">hex</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">expectedSignature</span><span class="p">);</span>

<span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">givenSignature</span><span class="p">);</span>

<span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code>
<span class="nv">$split_signature</span> <span class="o">=</span> <span class="s1">'1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f'</span><span class="p">;</span>

<span class="nv">$secret</span> <span class="o">=</span> <span class="s1">'1234'</span><span class="p">;</span>

<span class="nv">$message</span> <span class="o">=</span> <span class="s1">'full payload of the request'</span><span class="p">;</span>


<span class="k">list</span><span class="p">(</span><span class="nv">$timestamp</span><span class="p">,</span> <span class="nv">$given_signature</span><span class="p">,</span> <span class="nv">$other</span><span class="p">)</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="nv">$split_signature</span><span class="p">);</span>

<span class="nv">$signed_payload</span> <span class="o">=</span> <span class="nv">$timestamp</span> <span class="mf">.</span> <span class="s2">"."</span> <span class="mf">.</span> <span class="nv">$message</span><span class="p">;</span>

<span class="nv">$expected_signature</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">'sha256'</span><span class="p">,</span> <span class="nv">$signed_payload</span><span class="p">,</span> <span class="nv">$secret</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>


<span class="k">echo</span> <span class="nv">$expected_signature</span><span class="p">;</span>
<span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>

<span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

<span class="k">echo</span> <span class="nv">$given_signature</span><span class="p">;</span>
<span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>


</code></pre></div><div class="highlight"><pre class="highlight java tab-java"><code>
<span class="kn">import</span> <span class="nn">javax.crypto.Mac</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>


<span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="nc">String</span> <span class="n">splitSignature</span> <span class="o">=</span> <span class="s">"1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f"</span><span class="o">;</span>
      <span class="nc">String</span> <span class="n">secret</span> <span class="o">=</span> <span class="s">"1234"</span><span class="o">;</span>
      <span class="nc">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">"full payload of the request"</span><span class="o">;</span>


      <span class="nc">String</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">splitSignature</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">"\\."</span><span class="o">);</span>
      <span class="nc">String</span> <span class="n">timestamp</span> <span class="o">=</span> <span class="n">data</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
      <span class="nc">String</span> <span class="n">givenSignature</span> <span class="o">=</span> <span class="n">data</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>

      <span class="nc">String</span> <span class="n">signedPayload</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">message</span><span class="o">;</span>

      <span class="nc">Mac</span> <span class="n">sha256_HMAC</span> <span class="o">=</span> <span class="nc">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="nc">SecretKeySpec</span> <span class="n">secret_key</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">secret</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"HmacSHA256"</span><span class="o">);</span>
      <span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">secret_key</span><span class="o">);</span>

      <span class="nc">String</span> <span class="n">expectedSignature</span> <span class="o">=</span> <span class="n">javax</span><span class="o">.</span><span class="na">xml</span><span class="o">.</span><span class="na">bind</span><span class="o">.</span><span class="na">DatatypeConverter</span><span class="o">.</span><span class="na">printHexBinary</span><span class="o">(</span><span class="n">sha256_HMAC</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">signedPayload</span><span class="o">.</span><span class="na">getBytes</span><span class="o">())).</span><span class="na">toLowerCase</span><span class="o">();</span>

      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">expectedSignature</span><span class="o">);</span>
      <span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>

      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">givenSignature</span><span class="o">);</span>
      <span class="c1">// f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f</span>
    <span class="o">}</span>
    <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Error"</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>



</code></pre></div>
<!--



This example is commented out since the docs do not include C#

```csharp

using System;
using System.Security.Cryptography;

class MainClass {
  public static void Main (string[] args) {
    var splitSignature = "1514772000.f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f";
    var secret = "1234";
    var message = "full payload of the request";

    var header = splitSignature.Split('.');
    var timeStamp = header[0];
    var givenSignature = header[1];

    var signedPayload = timeStamp + "." + message;

    var encoding = new System.Text.ASCIIEncoding();
    var hmacsha256 = new HMACSHA256(encoding.GetBytes(secret));

    byte[] hashmessage = hmacsha256.ComputeHash(encoding.GetBytes(signedPayload));
    var expectedSignature = BitConverter.ToString(hashmessage).Replace("-", "").ToLower();

    Console.WriteLine(expectedSignature);
    // f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f

    Console.WriteLine(givenSignature);
    // f04cb05adb985b29d84616fbf3868e8e58403ff819cdc47ad8fc47e6acbce29f
  }
}


```

\-->

<p><strong>Step 1. Extract the timestamp and signatures from the header</strong></p>

<p>Split the header, using the <code>.</code> (dot) character as the separator, to get a list of elements.</p>

<table><thead>
<tr>
<th>Element</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>timestamp</code></td>
<td><a href="https://en.wikipedia.org/wiki/Unix_time">Unix time</a> in</td>
</tr>
<tr>
<td>seconds when the signature was created</td>
<td></td>
</tr>
<tr>
<td><code>signature</code></td>
<td>Request signature</td>
</tr>
<tr>
<td><code>other</code></td>
<td>Placeholder for future parameters (currently not used)</td>
</tr>
</tbody></table>

<p><strong>Step 2: Prepare the signed_payload string</strong></p>

<p>You achieve this by concatenating:</p>

<ul>
<li><p>The timestamp from the header (as a string)</p></li>
<li><p>The character <code>.</code> (dot)</p></li>
<li><p>The actual JSON payload (request body)</p></li>
</ul>

<p><strong>Step 3: Determine the expected signature</strong></p>

<p>Compute an HMAC with the SHA256 hash function. Use the endpoints signing secret as the key, and use the <code>signed_payload</code> string as the message.</p>

<p><strong>Step 4: Compare signatures</strong></p>

<p>Compare the signature in the header to the expected signature. If a signature matches, compute the difference between the current timestamp and the received timestamp, then decide if the difference is within your tolerance.</p>

<p>To protect against timing attacks, use a constant-time string comparison to compare the expected signature to each of the received signatures.</p>

<blockquote>
<p><strong><em>NOTE:</em></strong> The sandbox environment allow both HTTP and HTTPS webhook URLs. The live environment however will only POST to HTTPS URLs.</p>
</blockquote>

<p>Looking for more? Our docs are open sourced! <a href="https://github.com/zeptofs/api-documentation">https://github.com/zeptofs/api-documentation</a></p>
